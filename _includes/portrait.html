{% if include.lookup %}
  {% assign member = site.members 
    | where_exp: "member", "member.slug == include.lookup"
    | first
  %}
{% else %}
  {% assign member = include %}
{% endif %}

{% assign type = site.data.types[member.role] %}

<div class="portrait-wrapper">
  <a
    {% if page.slug != member.slug %}
      href="{{ member.url | relative_url | uri_escape }}"
    {% endif %}
    {% if include.tooltip and member.name and include.show_name == false %}
      data-tooltip="{{ member.name }} - {{ include.tooltip }}"
    {% else %}
      data-tooltip="{{ include.tooltip }}"
    {% endif %}
    class="portrait"
    data-style="{{ include.style }}"
    aria-label="{{ member.name | default: "member link" | regex_strip }}"
  >
    {% if type %}
      {% include icon.html icon=type.icon %}
    {% endif %}

    <img
      src="{{ member.image | relative_url | uri_escape }}"
      class="portrait-image"
      alt="member portrait"
      loading="lazy"
      {% include people_fallback.html %}
    >

    {% if member.name and include.show_name == true %}
      <span class="portrait-name">
        {{ member.name }}
      </span>
    {% endif %}
  </a>

  {% if member.cosupervisors %}
      <span class="portrait-cosupervision">
        {% include icon.html icon="fa-regular fa-handshake" %}
        {% for cosupervisor in member.cosupervisors %}
          {% assign external_collaborator = site.external_collaborators
            | where_exp: "external_collaborator", "external_collaborator.slug == cosupervisor"
            | first
          %}
          {% if external_collaborator %}
            <a href="{{ external_collaborator.links.home-page }}">
              {{ external_collaborator.name }}
            </a>
          {% else %}
              {{ cosupervisor }}
          {% endif %}
        {% endfor %}
      </span>
    {% endif %}

    <!-- {% if member.description or type %}
      <span class="portrait-description">
        {{ member.description | default: type.description }}
      </span>
    {% endif %} -->

    <!-- {% if member.affiliation %}
      <span class="portrait-affiliation">
        {{ member.affiliation }}
      </span>
    {% endif %} -->
   
  
</div>
